# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é Backend —Å–µ—Ä–≤–µ—Ä–∞

**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

---

## üéØ –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –¥–µ–ø–ª–æ—è Backend:

### 1. **–•–æ—Å—Ç–∏–Ω–≥ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞** (–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É):
   - ‚úÖ **Railway** - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ, $5 –∫—Ä–µ–¥–∏—Ç–æ–≤/–º–µ—Å—è—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –ë–ï–ó –∫–∞—Ä—Ç—ã)
   - ‚úÖ **Render** - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (750 —á–∞—Å–æ–≤/–º–µ—Å—è—Ü, —Å–ø–∏—Ç –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –ë–ï–ó –∫–∞—Ä—Ç—ã)
   - ‚úÖ **VPS/–°–µ—Ä–≤–µ—Ä** - –ü–ª–∞—Ç–Ω–æ, –Ω–æ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å

### 2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL:**
   - –í—Ö–æ–¥–∏—Ç –≤ Railway/Render (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
   - –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ: Supabase, Neon, ElephantSQL (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

### 3. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã
   - URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - API –∫–ª—é—á–∏ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

---

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 1: Railway (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê

### –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://railway.app
2. –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub
3. –ù–∞–∂–º–∏—Ç–µ **"New Project"**

### –®–∞–≥ 2: –î–µ–ø–ª–æ–π Backend
1. –í—ã–±–µ—Ä–∏—Ç–µ **"Deploy from GitHub repo"**
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `sadak`
3. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç Python –ø—Ä–æ–µ–∫—Ç

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞:
   - **Root Directory:** `backend`
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `uvicorn app.main:app --host 0.0.0.0 --port $PORT`

### –®–∞–≥ 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PostgreSQL
1. –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞–∂–º–∏—Ç–µ **"+ New"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Database"** ‚Üí **"Add PostgreSQL"**
3. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –±–∞–∑—É –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DATABASE_URL`

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–í Railway ‚Üí Settings ‚Üí Variables –¥–æ–±–∞–≤—å—Ç–µ:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è Railway)
DATABASE_URL=(Railway —Å–æ–∑–¥–∞—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

# Telegram Bot
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
TELEGRAM_SECRET_KEY=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á

# –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
YOOKASSA_SHOP_ID=–≤–∞—à_shop_id
YOOKASSA_SECRET_KEY=–≤–∞—à_secret_key
CLOUDPAYMENTS_PUBLIC_ID=–≤–∞—à_public_id
CLOUDPAYMENTS_API_SECRET=–≤–∞—à_api_secret

# E-Replika –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
E_REPLIKA_API_URL=https://bot.e-replika.ru/api
E_REPLIKA_AUTH_TOKEN=test_token_123

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
SECRET_KEY=—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ_—Å–ª—É—á–∞–π–Ω—ã–π_–∫–ª—é—á
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Environment
ENVIRONMENT=production

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ADMIN_TELEGRAM_IDS=123456789,987654321
```

### –®–∞–≥ 6: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
1. –í Railway –æ—Ç–∫—Ä–æ–π—Ç–µ **"Deployments"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"View Logs"**
3. –ò–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ Railway CLI:
```bash
railway connect
railway run alembic upgrade head
```

### –®–∞–≥ 7: –ü–æ–ª—É—á–µ–Ω–∏–µ URL
Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç URL —Ç–∏–ø–∞:
```
https://sadak-backend-production.up.railway.app
```

### –®–∞–≥ 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Frontend
–í Vercel ‚Üí Settings ‚Üí Environment Variables:
```
VITE_API_URL=https://sadak-backend-production.up.railway.app/api/v1
```

---

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 2: Render

### –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://render.com
2. –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Web Service
1. –ù–∞–∂–º–∏—Ç–µ **"New"** ‚Üí **"Web Service"**
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞
- **Name:** `sadak-backend`
- **Root Directory:** `backend`
- **Environment:** `Python 3`
- **Build Command:** `pip install -r requirements.txt`
- **Start Command:** `uvicorn app.main:app --host 0.0.0.0 --port $PORT`

### –®–∞–≥ 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PostgreSQL
1. **New** ‚Üí **PostgreSQL**
2. –ù–∞–∑–≤–∞–Ω–∏–µ: `sadak-db`
3. Render —Å–æ–∑–¥–∞—Å—Ç `DATABASE_URL` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –®–∞–≥ 5: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–í Render ‚Üí Environment:
```env
DATABASE_URL=(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç Render)
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
TELEGRAM_SECRET_KEY=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç
YOOKASSA_SHOP_ID=–≤–∞—à_id
YOOKASSA_SECRET_KEY=–≤–∞—à_–∫–ª—é—á
CLOUDPAYMENTS_PUBLIC_ID=–≤–∞—à_id
CLOUDPAYMENTS_API_SECRET=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç
E_REPLIKA_API_URL=https://bot.e-replika.ru/api
E_REPLIKA_AUTH_TOKEN=test_token_123
SECRET_KEY=—Å–ª—É—á–∞–π–Ω—ã–π_–∫–ª—é—á
ENVIRONMENT=production
```

### –®–∞–≥ 6: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
1. –í Render ‚Üí Shell –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
cd backend
alembic upgrade head
```

### –®–∞–≥ 7: –ü–æ–ª—É—á–µ–Ω–∏–µ URL
Render –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç:
```
https://sadak-backend.onrender.com
```

### –®–∞–≥ 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Frontend
–í Vercel:
```
VITE_API_URL=https://sadak-backend.onrender.com/api/v1
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** Render —Å–ø–∏—Ç –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (15 –º–∏–Ω—É—Ç), –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º.

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:

- [ ] ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git
- [ ] ‚úÖ `.env` —Ñ–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [ ] ‚úÖ `requirements.txt` –∞–∫—Ç—É–∞–ª–µ–Ω
- [ ] ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞/–ø–æ–¥–∫–ª—é—á–µ–Ω–∞
- [ ] ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã (alembic)
- [ ] ‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
- [ ] ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤–∞—à–µ–≥–æ frontend –¥–æ–º–µ–Ω–∞

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

### 1. –û–±–Ω–æ–≤–∏—Ç—å Frontend URL –≤ Backend CORS:
–í `backend/app/main.py` —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤–∞—à Vercel URL:
```python
origins = [
    "https://frontend-one-delta-95.vercel.app",
    "https://*.vercel.app",
]
```

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Webhooks –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º:
- **YooKassa:** `https://–≤–∞—à-backend-url.com/api/v1/webhooks/yookassa`
- **CloudPayments:** `https://–≤–∞—à-backend-url.com/api/v1/webhooks/cloudpayments`

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É API:
```bash
curl https://–≤–∞—à-backend-url.com/api/v1/health
curl https://–≤–∞—à-backend-url.com/api/v1/funds
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏:**
   - ‚ùå –ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ Git
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
   - ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—ã–π `SECRET_KEY`

2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - ‚úÖ –°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
   - ‚úÖ –°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

3. **CORS:**
   - ‚úÖ –î–æ–±–∞–≤—å—Ç–µ URL frontend –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
   - ‚úÖ –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã

4. **–õ–æ–≥–∏:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ (Sentry –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `requirements.txt` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î –∏–∑ —Å–µ—Ç–∏

### CORS –æ—à–∏–±–∫–∏:
1. –î–æ–±–∞–≤—å—Ç–µ frontend URL –≤ `origins`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

### Railway:
- Dashboard ‚Üí Metrics
- View Logs

### Render:
- Dashboard ‚Üí Metrics
- Logs –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. ‚úÖ –û–±–Ω–æ–≤–∏—Ç–µ `VITE_API_URL` –≤ Vercel
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É API —á–µ—Ä–µ–∑ Swagger: `https://–≤–∞—à-backend-url.com/docs`
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å e-replika
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhooks –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

---

**–ì–æ—Ç–æ–≤–æ! Backend –∑–∞–¥–µ–ø–ª–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!** üéâ

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
- [Railway Docs](https://docs.railway.app)
- [Render Docs](https://render.com/docs)

